---
import MaterialLayout from '../../../../layouts/MaterialLayout.astro';
import { getCollection } from 'astro:content';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = async () => {
  const courses = await getCollection('courses');
  const notes = await getCollection('notes', ({ data }) => !data.draft);
  return notes.map(note => {
    const course = courses.find(c => c.slug === note.data.course);
    return {
      params: { course: note.data.course, slug: note.slug },
      props: { entry: note, course },
    };
  });
};

const { entry, course } = Astro.props;
const { Content } = await entry.render();
---

<MaterialLayout
  title={entry.data.title}
  date={entry.data.date}
  lastUpdated={entry.data.lastUpdated}
  tags={entry.data.tags}
  pdfLink={entry.data.pdfLink}
  sourceLink={entry.data.sourceLink}
  solutionsAvailable={entry.data.solutionsAvailable}
  solutionsPublic={entry.data.solutionsPublic}
  courseSlug={course.slug}
  courseTitle={course.data.title}
  courseColor={course.data.color}
  materialType="notes"
  description={entry.data.description}
  math={entry.data.math}
>
  <Content />
</MaterialLayout>
