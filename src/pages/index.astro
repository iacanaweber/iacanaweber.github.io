---
import BaseLayout from '../layouts/BaseLayout.astro';
import CourseCard from '../components/CourseCard.astro';
import ProfileLinks from '../components/ProfileLinks.astro';
import { getCollection } from 'astro:content';
import { url } from '../utils/helpers';

const courses = (await getCollection('courses')).sort((a, b) => a.data.order - b.data.order);

const allPubs = await getCollection('publications');
const recentPubs = allPubs
  .sort((a, b) => b.data.year - a.data.year || a.data.order - b.data.order)
  .slice(0, 3);

const researchInterests = [
  'Hardware Security',
  'SoC Design',
  'Cryptography',
  'Digital Systems',
  'Embedded Systems',
  'TRNG',
  'Side-Channel Attacks',
  'Fault Injection',
  'Post-Quantum Crypto',
  'HW/SW Co-Design',
];
---

<BaseLayout title="Iaçanã Ianiski Weber" description="Personal academic site — courses, publications, and research in hardware security, SoC design, and cryptography.">
  <div class="container page-content">
    <!-- Hero -->
    <section class="hero">
      <h1>Iaçanã Ianiski Weber</h1>
      <p class="hero-role" data-i18n="home.role1">Adjunct Professor — <a href="https://portal.pucrs.br/en/ensino/escola-politecnica/" target="_blank" rel="noopener">School of Technology</a>, PUCRS</p>
      <p class="hero-role" data-i18n="home.role2">Senior Systems Engineer — <a href="https://www.ensilica.com/" target="_blank" rel="noopener">EnSilica</a></p>

      <ProfileLinks inline={true} />
    </section>

    <!-- Research Interests -->
    <section class="home-section">
      <h2 data-i18n="home.researchInterests">Research Interests</h2>
      <div class="pill-grid">
        {researchInterests.map(interest => (
          <span class="pill">{interest}</span>
        ))}
      </div>
    </section>

    <!-- Courses -->
    <section class="home-section">
      <div class="section-header">
        <h2 data-i18n="home.courses">Courses</h2>
        <a href={url('/courses/')} class="see-all" data-i18n="home.seeAll">See all</a>
      </div>
      <div class="course-grid">
        {courses.map(course => (
          <CourseCard
            slug={course.slug}
            title={course.data.title}
            shortName={course.data.shortName}
            description={course.data.description}
            semester={course.data.semester}
            color={course.data.color}
          />
        ))}
      </div>
    </section>

    <!-- Recent Publications -->
    {recentPubs.length > 0 && (
      <section class="home-section">
        <div class="section-header">
          <h2 data-i18n="home.recentPublications">Recent Publications</h2>
          <a href={url('/publications/')} class="see-all" data-i18n="home.seeAll">See all</a>
        </div>
        <div class="pub-list">
          {recentPubs.map(pub => (
            <div class="pub-entry">
              <p class="pub-citation">
                {pub.data.authors} ({pub.data.year}).
                <strong>{pub.data.title}</strong>.
                <em>{pub.data.venue}</em>.
                {pub.data.doi && (
                  <span> DOI: <a href={`https://doi.org/${pub.data.doi}`} target="_blank" rel="noopener">{pub.data.doi}</a></span>
                )}
              </p>
              {pub.data.url && (
                <a href={pub.data.url} target="_blank" rel="noopener" class="pub-link" data-i18n="publications.viewPaper">View Paper</a>
              )}
            </div>
          ))}
        </div>
      </section>
    )}
  </div>
</BaseLayout>

<style>
  .hero {
    text-align: center;
    padding: var(--space-12) 0 var(--space-8);
  }

  .hero h1 {
    font-size: clamp(2rem, 5vw, 3.5rem);
    margin-bottom: var(--space-2);
  }

  .hero-role {
    color: var(--color-text-secondary);
    font-size: var(--font-size-lg);
    margin: 0;
    line-height: 1.6;
  }

  .hero-role + .hero-role {
    margin-bottom: var(--space-4);
  }

  .home-section {
    margin-top: var(--space-12);
  }

  .section-header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    margin-bottom: var(--space-6);
  }

  .section-header h2 {
    margin-bottom: 0;
  }

  .see-all {
    font-size: var(--font-size-sm);
    font-weight: 600;
    white-space: nowrap;
  }

  /* Research interest pills */
  .pill-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }

  .pill {
    display: inline-block;
    padding: var(--space-1) var(--space-3);
    background: var(--color-primary-light);
    color: var(--color-primary);
    border-radius: 9999px;
    font-size: var(--font-size-sm);
    font-weight: 600;
    white-space: nowrap;
  }

  /* Publications */
  .pub-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  .pub-entry {
    padding: var(--space-4) var(--space-5);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-surface);
  }

  .pub-citation {
    margin-bottom: var(--space-2);
    line-height: 1.6;
  }

  .pub-citation em {
    color: var(--color-text-secondary);
  }

  .pub-link {
    display: inline-block;
    font-size: var(--font-size-sm);
    font-weight: 600;
  }
</style>
