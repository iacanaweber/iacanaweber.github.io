---
title: "Exercise List 1: Vulnerability Analysis"
course: "css"
date: 2025-03-19
tags: ["Vulnerabilities", "OWASP", "Security"]
description: "Exercises on identifying, classifying, and mitigating common software vulnerabilities."
solutionsAvailable: true
solutionsPublic: true
---

## Instructions

Analyze the following code snippets and scenarios. Identify vulnerabilities, classify them, and propose mitigations.

## Questions

### Q1 — SQL Injection

Consider the following Python code:

```python
def get_user(username):
    query = f"SELECT * FROM users WHERE name = '{username}'"
    return db.execute(query)
```

a) Explain how an attacker could exploit this code.
b) Provide a malicious input that would extract all users from the database.
c) Rewrite the function to prevent this vulnerability.

### Q2 — Cross-Site Scripting (XSS)

The following HTML template displays a user's comment:

```html
<div class="comment">
  <p>{{ comment.text }}</p>
</div>
```

a) If `comment.text` is not sanitized, what kind of XSS attack is possible?
b) Provide an example malicious input.
c) What is the difference between stored XSS and reflected XSS?

### Q3 — Buffer Overflow

Analyze this C function:

```c
void greet(char *name) {
    char buffer[64];
    sprintf(buffer, "Hello, %s! Welcome.", name);
    printf("%s\n", buffer);
}
```

a) What vulnerability exists in this code?
b) What could an attacker achieve by exploiting it?
c) Propose two different fixes.

### Q4 — Classification

Classify each of the following vulnerabilities using the OWASP Top 10 (2021) categories:

a) An application stores passwords in plaintext.
b) An API endpoint does not check if the logged-in user has permission to access the requested resource.
c) An application uses a library with a known CVE that allows remote code execution.
d) XML parsing accepts external entity definitions from user input.

### Q5 — Threat Assessment

For a web application that handles student grades:

a) List three assets that need protection.
b) Identify two potential threat actors and their motivations.
c) For each threat actor, describe one plausible attack scenario.

---

## Solutions

### S1

a) The input is concatenated directly into the SQL query without sanitization, allowing an attacker to inject arbitrary SQL.

b) Input: `' OR '1'='1' --` would make the query return all users.

c) Use parameterized queries:
```python
def get_user(username):
    query = "SELECT * FROM users WHERE name = ?"
    return db.execute(query, (username,))
```
